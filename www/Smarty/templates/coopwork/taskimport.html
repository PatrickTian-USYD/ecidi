<!DOCTYPE html>
<!-- 
Template Name: Metronic - Responsive Admin Dashboard Template build with Twitter Bootstrap 3.3.6
Version: 4.5.6
Author: KeenThemes
Website: http://www.keenthemes.com/
Contact: support@keenthemes.com
Follow: www.twitter.com/keenthemes
Dribbble: www.dribbble.com/keenthemes
Like: www.facebook.com/keenthemes
Purchase: http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes
Renew Support: http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes
License: You must have a valid license purchased only from themeforest(the above link) in order to legally use the theme for your project.
-->


<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->

<html lang="en">
    <!--<![endif]-->
    <!-- BEGIN HEAD -->

    <head>
        <meta charset="utf-8" />
        <title>任务项导入工具</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta content="width=device-width, initial-scale=1" name="viewport" />
        <meta content="" name="description" />
        <meta content="" name="author" />
        <!-- BEGIN GLOBAL MANDATORY STYLES -->
        
        <link href="style/assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
        <link href="style/assets/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css" />
        <link href="style/assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="style/assets/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css" rel="stylesheet" type="text/css" />
        <!-- END GLOBAL MANDATORY STYLES -->
        
        <!-- BEGIN PAGE LEVEL PLUGINS -->
        <link href="style/assets/global/plugins/fancybox/source/jquery.fancybox.css" rel="stylesheet" type="text/css" />
        <link href="style/assets/global/plugins/jquery-file-upload/blueimp-gallery/blueimp-gallery.min.css" rel="stylesheet" type="text/css" />
        <link href="style/assets/global/plugins/jquery-file-upload/css/jquery.fileupload.css" rel="stylesheet" type="text/css" />
        <link href="style/assets/global/plugins/jquery-file-upload/css/jquery.fileupload-ui.css" rel="stylesheet" type="text/css" />
        <!-- END PAGE LEVEL PLUGINS -->
        <!-- BEGIN THEME GLOBAL STYLES -->
        <link href="style/assets/global/css/components.min.css" rel="stylesheet" id="style_components" type="text/css" />
        <link href="style/assets/global/css/plugins.min.css" rel="stylesheet" type="text/css" />
        <!-- END THEME GLOBAL STYLES -->
        <!-- BEGIN THEME LAYOUT STYLES -->
        <link href="style/assets/layouts/layout/css/layout.min.css" rel="stylesheet" type="text/css" />
        <link href="style/assets/layouts/layout/css/themes/darkblue.min.css" rel="stylesheet" type="text/css" id="style_color" />
        <link href="style/assets/layouts/layout/css/custom.min.css" rel="stylesheet" type="text/css" />
        <!-- END THEME LAYOUT STYLES -->
        <link rel="shortcut icon" href="favicon.ico" /> </head>
    <!-- END HEAD -->

    <body class="page-header-fixed page-sidebar-closed-hide-logo page-content-white">


        <!-- BEGIN CONTAINER 
        <div class="page-container">-->

            <!-- BEGIN CONTENT 
            <div class="page-content-wrapper">-->
                <!-- BEGIN CONTENT BODY -->
                <div class="page-content" style="margin-left:0px;margin-top:0px;margin-right:0px">
                    <!-- BEGIN PAGE HEADER-->
                    <!-- BEGIN THEME PANEL -->
                    <!-- END THEME PANEL -->
                    <!-- BEGIN PAGE BAR -->
                    
                    <!-- END PAGE BAR -->
                    <!-- BEGIN PAGE TITLE-->
                    <!--<h3 class="page-title" style="margin-left:0px;margin-top:0px;margin-right:0px"> User Cards Elements
                        <small>Elements are small components to be used within a layout</small>
                    </h3>-->
                    <!-- END PAGE TITLE-->
                    <!-- END PAGE HEADER-->
                    <!-- BEGIN : USER CARDS -->
<!-- 
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
begin ipaddress information page
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
-->      
<div class="row">
     <div class="col-md-12">
          <div class="portlet light portlet-fit " style="margin-left:2px;margin-top:2px;margin-right:2px;">                                            
               <div class="portlet box green">
                    <div class="portlet-title">
                         <div class="caption">
                               <i class="fa fa-gift"></i>
                         </div>
                         <input type="hidden" id="hostid" value="" />
                         <div class="tools">
                              <a href="javascript:;" class="collapse"> </a>
                              <a href="#portlet-config" data-toggle="modal" class="config"> </a>
                              <a href="" class="fullscreen"> </a>
                              <a href="javascript:;"  class="reload"> </a>
                         </div>
                    </div>
                    <div class="portlet-body" id="devicepanelname" >

           
                        <div class="row">
                            <div class="col-md-12">
                               <form id="fileupload" action="style/assets/global/plugins/jquery-file-upload/server/php/" method="POST" enctype="multipart/form-data" class="form-horizontal">
                                        <div class="form-body" >
                                            <div class="alert alert-danger display-hide">
                                                <button class="close" data-close="alert"></button> <label id="alertdangerlabel" name="alertdangerlabel">设备访问用户模板信息输入有问题， 请确认。</label> </div>
                                            <div class="alert alert-success display-hide">
                                                <button class="close" data-close="alert"></button> <label id="alertsuccesslabel" name="alertsuccesslabel">设备访问用户模板信息保存成功!</label>  

                                            </div>

                                            <div id="IpSegmentImg" class="form-group" >
                                                <label class="control-label col-md-3">导入文件格式示例
                                                </label>
                                                <div class="col-md-8">
                                                     <img alt="" src="images/import/task.png"><!-- style="width:635px;" -->
                                                     <a href="images/import/task.xlsx">下载格式文件</a>
                                                </div>
                                            </div>
                                            

                                            
                                            <div class="form-group"> 
                                                 <label class="control-label col-md-3" name="vlanlabel" id="vlanlabel">导入文件
                                                 <input type="hidden" name="FileName"  id="FileName" value="">
                                                 <input type="hidden" name="FileServerName" id="FileServerName" value="">
                                                 <input type="hidden" name="FileSize"  id="FileSize" value="">
                                                 </label>
                                                <div class="col-md-8">
                                                     <table style="width:100%;">
                                                          <tr>
                                                               <td>
                                                                    <span class="btn green fileinput-button">
                                            		        	         <i class="fa fa-plus"></i>
                                            		        	         <span> 请选择需要导入的文件... </span>
                                            		        	         <input type="file" id="upbtn"> 
                                        					        </span>    
                                        					        <div class="progress progress-striped active" style="display:none" role="progressbar" aria-valuemin="0" aria-valuemax="100">
                                                                         <div class="progress-bar progress-bar-success" style="width:0%;"> </div>
                                                                    </div>
                                                                     <!-- The extended global progress information -->
                                                                    <div class="progress-extended" style="display:none" ></div>                                                    
                                                               </td>
                                                         </tr>
                                                         <tr>
                                                               <td>
                                                                  <table id="filelisttable" role="presentation" class="table table-striped clearfix" >
                                                                       <tbody class="files"> </tbody>
                                                                  </table>
                                                               </td>
                                                         </tr>
                                                    </table>
                                                    <div class="row fileupload-buttonbar">
                                                    	<!-- The fileinput-button span is used to style the file input field as button -->
                                                    	<!-- The global file processing state -->
                                                        <span class="fileupload-process"> </span>
                                                    	<!-- The global progress information 
                                                        <div class="col-lg-5 fileupload-progress fade">-->
                                                    	<!-- The global progress bar -->
                                                    </div>
                                                    <!-- The table listing the files available for upload/download -->
                                                </div>
                                            </div>                  
                                        </div>
                                        <!-- <div class="form-actions"> -->
                                            <div class="row">
                                            <!--  
                                                <div class="col-md-offset-3 col-md-9">
                                                    <button type="submit" class="btn green">Submit</button>
                                                    <button type="button" class="btn grey-salsa btn-outline">Cancel</button>
                                                </div>-->
                                                <div class=" col-md-11">
                                                    <div style="float:right;margin-top:-14px;margin-right:16px">
                                                        <input id="SaveBtn" name="SaveBtn" type="button" class="btn green" value="导入"></input>
                                                        
                                                    	<input id="CloseBtn" name="CloseBtn" type="button" class="btn red" data-dismiss="modal" value="关闭" onclick="javascript:window.opener=null;window.open('','_self');window.close();"></input>
                                                    	
                                                    </div>
                                                </div>
                                            </div>
                                        <!--</div>-->
                            </div>
                        </div>  
                   </div> 
               </div>  
          </div>                       
     </div>        
</div>

                   <div id="blueimp-gallery" class="blueimp-gallery blueimp-gallery-controls" data-filter=":even">
                        <div class="slides"> </div>
                        <h3 class="title"></h3>
                        <a class="prev"> ‹ </a>
                        <a class="next"> › </a>
                        <a class="close white"> </a>
                        <a class="play-pause"> </a>
                        <ol class="indicator"> </ol>
                    </div>
                    <!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->
                    <script id="template-upload" type="text/x-tmpl"> {% for (var i=0, file; file=o.files[i]; i++) { %}
                        <tr class="template-upload fade">
                            <td>
                                <span class="preview"></span>
                            </td>
                            <td>
                                <p class="name">{%=file.name%}</p>
                                <strong class="error text-danger label label-danger"></strong>
                            </td>
                            <td>
                                <p class="size">Processing...</p>
                                <div class="progress progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
                                    <div class="progress-bar progress-bar-success" style="width:0%;"></div>
                                </div>
                            </td>
                            <td> {% if (!i && !o.options.autoUpload) { %}
                                <button class="btn blue start" disabled>
                                    <i class="fa fa-upload"></i>
                                    <span>上传</span>
                                </button> {% } %} {% if (!i) { %}
                                <button class="btn red cancel">
                                    <i class="fa fa-ban"></i>
                                    <span>取消</span>
                                </button> {% } %} </td>
                        </tr> {% } %} </script>
                    <!-- The template to display files available for download -->
                    <script id="template-download" type="text/x-tmpl"> {% for (var i=0, file; file=o.files[i]; i++) { document.getElementById("FileServerName").value=file.name;document.getElementById("FileSize").value=o.formatFileSize(file.size);%}
                        <tr class="template-download fade">
                            <td>
                                <span class="preview"> {% if (file.thumbnailUrl) { %}
                                    <a href="{%=file.url%}" title="{%=file.name%}" download="{%=file.name%}" data-gallery>
                                        <img src="{%=file.thumbnailUrl%}">
                                    </a> {% } %} </span>
                            </td>
                            <td>
                                <p class="name"> {% if (file.url) { %}
                                    <a href="{%=file.url%}" title="{%=file.name%}" download="{%=file.name%}" {%=file.thumbnailUrl? 'data-gallery': ''%}>{%=file.name%}</a> {% } else { %}
                                    <span>{%=file.name%}</span> {% } %} </p> {% if (file.error) { %}
                                <div>
                                    </div> {% } %} </td>
                            <td>
                                <span class="size">{%=o.formatFileSize(file.size)%}</span>
                            </td>
                            <td> {% if (file.deleteUrl) { %}
                                <button class="btn red delete btn-sm" data-type="{%=file.deleteType%}" data-url="{%=file.deleteUrl%}" {% if (file.deleteWithCredentials) { %} data-xhr-fields='{"withCredentials":true}' {% } %}>
                                    <i class="fa fa-trash-o"></i>
                                    <span>删除</span>
                                </button>
                                <input type="checkbox" name="delete" value="1" class="toggle"> {% } else { %}
                                <button class="btn yellow cancel btn-sm">
                                    <i class="fa fa-ban"></i>
                                    <span>删除</span>
                                </button> {% } %} </td>
                        </tr> {% } %} </script>
                </div>




    
                               
                    
                    

                    
<!-- 
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
end equipmentinfor page
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
-->
                    <!-- END : USER CARDS -->
                </div>
                <!-- END CONTENT BODY -->
            
            <!-- </div>END CONTENT -->
 
        
        <!-- </div>END CONTAINER -->

        <!--[if lt IE 9]>
<script src="style/assets/global/plugins/respond.min.js"></script>
<script src="style/assets/global/plugins/excanvas.min.js"></script> 
<![endif]-->


        <!-- BEGIN CORE PLUGINS -->
        <script src="style/assets/global/plugins/jquery.min.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/js.cookie.min.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/jquery.blockui.min.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/bootstrap-switch/js/bootstrap-switch.min.js" type="text/javascript"></script>
        <!-- END CORE PLUGINS -->
        <!-- BEGIN PAGE LEVEL PLUGINS -->
        <script src="style/assets/global/plugins/fancybox/source/jquery.fancybox.pack.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/jquery-file-upload/js/vendor/jquery.ui.widget.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/jquery-file-upload/js/vendor/tmpl.min.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/jquery-file-upload/js/vendor/load-image.min.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/jquery-file-upload/js/vendor/canvas-to-blob.min.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/jquery-file-upload/blueimp-gallery/jquery.blueimp-gallery.min.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/jquery-file-upload/js/jquery.iframe-transport.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/jquery-file-upload/js/jquery.fileupload.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/jquery-file-upload/js/jquery.fileupload-process.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/jquery-file-upload/js/jquery.fileupload-image.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/jquery-file-upload/js/jquery.fileupload-audio.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/jquery-file-upload/js/jquery.fileupload-video.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/jquery-file-upload/js/jquery.fileupload-validate.js" type="text/javascript"></script>
        <script src="style/assets/global/plugins/jquery-file-upload/js/jquery.fileupload-ui.js" type="text/javascript"></script>
        <!-- END PAGE LEVEL PLUGINS -->
        <!-- BEGIN THEME GLOBAL SCRIPTS -->
        <script src="style/assets/global/scripts/app.min.js" type="text/javascript"></script>


        <!-- BEGIN PAGE LEVEL SCRIPTS -->
                <!-- BEGIN PAGE LEVEL SCRIPTS -->
        <script src="style/AjaxData/resourcess/form-fileupload-ipaddressimport.js" type="text/javascript"></script>
        <!-- END PAGE LEVEL SCRIPTS -->
        <!-- BEGIN THEME LAYOUT SCRIPTS -->
        <script src="style/assets/layouts/layout/scripts/layout.min.js" type="text/javascript"></script>
        <script src="style/assets/layouts/layout/scripts/demo.min.js" type="text/javascript"></script>
        <script src="style/assets/layouts/global/scripts/quick-sidebar.min.js" type="text/javascript"></script>

        <!-- END THEME LAYOUT SCRIPTS -->

    </body>

</html>
<!--[if lt IE 9]>
  <script src="style/assets/html5shiv.min.js"></script>
  <script src="style/assets/respond.min.js"></script>
<![endif]-->
<script>
//alert("#deviceimg");
$(document).ready(function(){
	
	return;
	alert("kkkk");
	var RowContext="";
	
	
	RowContext = RowContext + "<table class='table table-striped table-hover table-bordered dt-responsive' id='sample_editable_1'>";
	RowContext = RowContext + "<thead>";
	RowContext = RowContext + "<tr>";
	RowContext = RowContext + "<th data-field='ipaddress'> Username </th>";
	RowContext = RowContext + "<th data-field='name'> Full Name </th>";
	RowContext = RowContext + "<th data-field='type'> Points </th>";
	RowContext = RowContext + "<th data-field='date'> Notes </th>";
	RowContext = RowContext + "<th data-field='action1'> Edit </th>";
	RowContext = RowContext + "<th data-field='action2'> Delete </th>";
	RowContext = RowContext + "</tr>";
	RowContext = RowContext + "</thead>";
	RowContext = RowContext + "<tbody>";
	RowContext = RowContext + "<tr>";
	RowContext = RowContext + "<td> alex </td>";
	RowContext = RowContext + "<td> Alex Nilson </td>";
	RowContext = RowContext + "<td> 1234 </td>";
	RowContext = RowContext + "<td class='center'> power user </td>";
	RowContext = RowContext + "<td><a class='edit' href='javascript:;'> Edit </a></td>";
	RowContext = RowContext + "<td><a class='delete' href='javascript:;'> Delete </a></td>";
	RowContext = RowContext + "</tr>";
	RowContext = RowContext + "</tbody>";
	RowContext = RowContext + "</table>";
	
	$("#TableContent").html(RowContext); 
	TableDatatablesEditable.init();
	return;
	var rows=[];
	var startId=100;
    for (var i = 0; i < 10; i++) {
        rows.push({
        	ipaddress: startId + i,
            name: 'test' + (startId + i),
            type: '$' + (startId + i),
            date: 'test' + (startId + i),
            action1: '$' + (startId + i), 
            action2: '$' + (startId + i)
        });
    }
	//var DataObj = '[{ipaddress:"172.18.32.2",name:"n130509",type:"guding",date:"2017-1-3",action1:"f",action2:"c"},{ipaddress:"172.18.32.2",name:"n130509",type:"guding",date:"2017-1-3",action1:"f",action2:"c"}]';
	//Jsonobj = JSON.parse(DataObj);
	alert(RowContext);
	//alert(Jsonobj);
	
	try
	{
		//$("#sample_editable_1").bootstrapTable('load', rows);//.refresh(RowContext);
		//$("#sample_editable_1").bootstrapTable('refresh');//.refresh(RowContext)
		//$("#sample_editable_1").load(rows);//.refresh(RowContext);
		//$("#sample_editable_1").refresh();
	}
	catch(err)
	{
		alert('修改[区域信息]异常，异常信息如下：'+err.message +"|" + err.description);
		
	}


});



$("button.delete").click(function() {
    alert("delete");
});

$("#SaveBtn").on('click',function(){
	var ImportWay="";
	alert("1");
	var tableObj = document.getElementById('filelisttable').rows[0];
    if (tableObj == null)
    {
    	alert("您还没有选择导入的文件，请选择文件后导入！");
    	return false;
    }
    alert("2");
    var formdata=$('#fileupload').serialize();
    formdata=decodeURIComponent(formdata,true);
    alert(formdata);
    
    $.ajax({
    	cache: false,
  	    type: "POST",
        url: "FormData/coopwork/taskplan.php",
        data: {mydate:[{'jsonrpc':'2.0','method':'import_taskplan','datatype':'','formdata':formdata}]},     
        success: function(data){
        	var dataObj = eval("("+data+")");
        	//alert(dataObj);
        	try
        	{
        		if(dataObj["status"]=="1")
        		{
        			alert("成功导入["+dataObj["result"]+"]条任务项信息！");
        		}
        		else
        		{
        			alert("任务项信息导入失败,失败信息:"+dataObj["result"]);
        		}
        	}
        	catch(err)
        	{
        		alert("任务项信息导入失败,失败信息:"+err.message);
        		//alert( +"|" + err.description);
        	}
        	//alert(tempAjax);

          //返回数据后操作
        },
        error: function(){alert("任务项信息导入失败");}
     });
    
});
/*
            
                                                
                                                
                                                

*/
</script>